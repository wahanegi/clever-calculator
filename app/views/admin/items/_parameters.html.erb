<% def render_delete_button(path, confirm_message) %>
  <%= link_to "Delete", path, method: :delete, data: { confirm: confirm_message } %>
<% end %>

<% item_key = item.id || "new" %>

<% if fixed_parameters.any? %>
  <h3>Fixed Parameters</h3>
  <table class="parameter-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Value</th>
        <% if mode == :edit %>
          <th>Actions</th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% fixed_parameters.each do |name, value| %>
        <tr>
          <td><%= name %></td>
          <td><%= value %></td>
          <% if mode == :edit %>
            <td>
              <%= render_delete_button(
                remove_parameter_admin_item_path(item_key, param_type: :fixed, param_key: name.to_s),
                "Delete fixed param '#{name}'?"
              ) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if open_parameters_label.any? %>
  <h3>Open Parameters</h3>
  <table class="parameter-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Value</th>
        <% if mode == :edit %>
          <th>Actions</th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% open_parameters_label.each do |label| %>
        <tr>
          <td><%= label %></td>
          <td>Value is entered by the user</td>
          <% if mode == :edit %>
            <td>
              <%= render_delete_button(
                remove_parameter_admin_item_path(item_key, param_type: :open, param_key: label),
                "Delete open param '#{label}'?"
              ) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if select_parameters.any? %>
  <h3>Select Parameters</h3>
  <% select_parameters.each do |sel_name, raw_param_data| %>
    <% param_data = raw_param_data.with_indifferent_access %>
    <% value_label = param_data[:value_label] || "â€”" %>
    <% options_data = param_data[:options] || {} %>

    <h4>
      Select name: <%= sel_name %>
      <% if mode == :edit %>
        <%= render_delete_button(
          remove_parameter_admin_item_path(item_key, param_type: :select, param_key: sel_name),
          "Delete whole select '#{sel_name}' and its options?"
        ) %>
      <% end %>
    </h4>

    <p>Value Label: <%= value_label %></p>

    <table class="parameter-table">
      <thead>
        <tr>
          <th>Options</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <% options_data.each do |desc, val| %>
          <tr>
            <td><%= desc %></td>
            <td><%= val %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
<% end %>

